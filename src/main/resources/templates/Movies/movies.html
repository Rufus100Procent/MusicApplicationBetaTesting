<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>My Favorite Movies</title>
    <style>
        /* Your existing CSS styles here */
    </style>
</head>
<body>
<div class="topnav">
    <a class="active" href="#">Home</a>
    <a href="/songs">Music</a>
    <a href="/Movies">Movies</a>
    <a href="/TV-Shows">TV-Shows</a>
    <a href="/">About</a>
</div>
<h1>My Favorite Movies</h1>

<header>
    <button id="addMovieBtn"><i class="fas fa-plus"></i> Add Movie</button>
    <input type="file" id="fileInput" accept="image/*" style="display: none;">
</header>

<div id="movieForm" style="display: none;">
    <h2>Add a Movie</h2>
    <form id="uploadMovieForm" enctype="multipart/form-data">
        <label for="movieName">Movie Name:</label>
        <input type="text" id="movieName" name="movieName" required><br>

        <label for="producer">Producer:</label>
        <input type="text" id="producer" name="producer" required><br>

        <label for="releaseYear">Release Year:</label>
        <input type="number" id="releaseYear" name="releaseYear" required><br>

        <label for="movieImage">Select Movie Image:</label>
        <input type="file" id="movieImage" name="movieImage" accept="image/*" required><br>

        <button type="submit">Upload Movie</button>
    </form>
</div>

<div id="movieContainer" class="container">
    <!-- Movie images will be displayed here -->
</div>

<script>
    const addMovieBtn = document.getElementById('addMovieBtn');
    const fileInput = document.getElementById('fileInput');
    const movieForm = document.getElementById('movieForm');
    const uploadMovieForm = document.getElementById('uploadMovieForm');
    const movieContainer = document.getElementById('movieContainer');

    addMovieBtn.addEventListener('click', () => {
        movieForm.style.display = 'block';
    });

    fileInput.addEventListener('change', (e) => {
        // Handle file selection and display as you did before
    });

    uploadMovieForm.addEventListener('submit', async (e) => {
        e.preventDefault();

        const formData = new FormData(uploadMovieForm);

        try {
            const response = await fetch('/movies', {
                method: 'POST',
                body: formData,
            });

            if (response.ok) {
                const movieData = await response.json();

                // Save movie data to localStorage
                localStorage.setItem('movieName', movieData.movieName);
                localStorage.setItem('producer', movieData.producer);
                localStorage.setItem('releaseYear', movieData.releaseYear);

                // Display the movie image on the page
                const movieDiv = document.createElement('div');
                movieDiv.classList.add('movie');

                const movieImage = document.createElement('img');
                movieImage.src = movieData.imagePath;
                movieDiv.appendChild(movieImage);

                movieContainer.appendChild(movieDiv);

                // Hide the movie form
                movieForm.style.display = 'none';
            } else {
                const errorMessage = await response.text();
                alert(errorMessage);
            }
        } catch (error) {
            console.error('Error uploading movie:', error);
        }
    });
</script>
</body>
</html>
