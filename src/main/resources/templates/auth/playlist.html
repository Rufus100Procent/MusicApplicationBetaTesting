<!DOCTYPE html>
<html>
<head>
  <title>Playlist Page</title>
  <style>
    /* Style for the popup */
    .popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #f1f1f1;
      padding: 20px;
      border: 1px solid #ccc;
    }

    /* Style for the shake animation */
    .shake {
      animation: shake 0.4s linear;
    }

    /* Shake animation keyframes */
    @keyframes shake {
      0% { transform: translateX(0); }
      20% { transform: translateX(-10px); }
      40% { transform: translateX(10px); }
      60% { transform: translateX(-10px); }
      80% { transform: translateX(10px); }
      100% { transform: translateX(0); }
    }

    /* Style for error message */
    .error-message {
      color: red;
      font-weight: bold;
    }

    /* Style for playlist container */
    .playlist-container {
      margin-top: 20px;
    }

    /* Style for playlist item */
    .playlist-item {
      margin-bottom: 10px;
    }

    /* Style for delete button */
    .delete-button {
      margin-left: 10px;
    }

    /* Style for display popup */
    .display-popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #f1f1f1;
      padding: 20px;
      border: 1px solid #ccc;
      z-index: 9999;
    }
  </style>
</head>
<body>
<button onclick="openPopup()">Playlist</button>

<div id="popup" class="popup">
  <input type="text" id="playlistName" placeholder="Enter playlist name">
  <button onclick="createPlaylist()">Create</button>
  <p id="errorMessage" class="error-message" style="display: none;"></p>
</div>

<div id="playlistContainer" class="playlist-container"></div>

<div>
  <button id="deleteButton" class="delete-button" onclick="toggleCheckboxes()">Delete</button>
  <div id="displayPopup" class="display-popup"></div>
</div>

<script>
  var deleteButton = document.getElementById("deleteButton");
  deleteButton.disabled = true;

  function openPopup() {
    var popup = document.getElementById("popup");
    popup.style.display = "block";
    resetErrorMessage();
  }

  function createPlaylist() {
    var playlistName = document.getElementById("playlistName").value;
    var existingNames = Array.from(document.querySelectorAll(".playlist-item label")).map(item => item.innerHTML);

    // Check if the playlist name already exists
    if (existingNames.includes(playlistName)) {
      displayErrorMessage(playlistName + " already exists. Please choose a different name.");
      shakeTextField();
    } else {
      // Create a new playlist item
      var playlistItem = document.createElement("div");
      playlistItem.className = "playlist-item";

      // Create checkbox for the playlist item
      var checkbox = document.createElement("input");
      checkbox.type = "checkbox";
      checkbox.style.display = "none";
      playlistItem.appendChild(checkbox);

      // Create label for the checkbox
      var label = document.createElement("label");
      label.innerHTML = playlistName;
      playlistItem.appendChild(label);

      // Append the playlist item to the container
      var playlistContainer = document.getElementById("playlistContainer");
      playlistContainer.appendChild(playlistItem);

      // Enable the delete button
      deleteButton.disabled = false;

      // Close the popup
      var popup = document.getElementById("popup");
      popup.style.display = "none";
    }
  }

  function toggleCheckboxes() {
    var checkboxes = document.querySelectorAll(".playlist-item input[type='checkbox']");

    if (deleteButton.innerHTML === "Delete") {
      checkboxes.forEach(function(checkbox) {
        checkbox.style.display = "inline-block";
      });
      deleteButton.innerHTML = "Delete Selected";
    } else {
      checkboxes.forEach(function(checkbox) {
        checkbox.style.display = "none";
      });
      deleteButton.innerHTML = "Delete";
    }
  }

  function deleteSelectedPlaylists() {
    var checkboxes = document.querySelectorAll(".playlist-item input[type='checkbox']");
    var selectedPlaylists = [];

    checkboxes.forEach(function(checkbox) {
      if (checkbox.checked) {
        selectedPlaylists.push(checkbox.nextSibling.innerHTML);
        checkbox.parentNode.parentNode.removeChild(checkbox.parentNode);
      }
    });

    // Hide the display popup after 1 second
    var displayPopup = document.getElementById("displayPopup");
    displayPopup.innerHTML = selectedPlaylists.join(", ") + " have been successfully deleted.";
    displayPopup.style.display = "block";
    setTimeout(function() {
      displayPopup.style.display = "none";
    }, 1000);

    // Disable the delete button if no playlists are left
    var playlistItems = document.querySelectorAll(".playlist-item");
    if (playlistItems.length === 0) {
      deleteButton.disabled = true;
    }
  }

  function shakeTextField() {
    var textField = document.getElementById("playlistName");
    textField.classList.add("shake");
    textField.addEventListener("animationend", removeShakeAnimation);
  }

  function removeShakeAnimation() {
    var textField = document.getElementById("playlistName");
    textField.classList.remove("shake");
  }

  function displayErrorMessage(message) {
    var errorMessage = document.getElementById("errorMessage");
    errorMessage.style.display = "block";
    errorMessage.innerHTML = message;
  }

  function resetErrorMessage() {
    var errorMessage = document.getElementById("errorMessage");
    errorMessage.style.display = "none";
    errorMessage.innerHTML = "";
  }
</script>
</body>
</html>
